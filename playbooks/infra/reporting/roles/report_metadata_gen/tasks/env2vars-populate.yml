---

- name: Include env2vars variable for {{ rmg_ci_system }}
  ansible.builtin.include_vars:
    dir: "{{ role_path }}/vars/env2vars"
    files_matching: "{{ rmg_ci_system }}.yml"

- name: Set facts from environment variables into rmg_vars_dict
  ansible.builtin.set_fact:
    rmg_vars_dict: "{{ rmg_vars_dict | default({}) | combine({(item.key): processed_value}) }}"
  vars:
    processed_value: "{{ lookup('template', role_path ~ '/templates/env2vars.j2') }}"
  loop: "{{ env2vars }}"
  when:
    - env2vars | default({}) | length > 0
